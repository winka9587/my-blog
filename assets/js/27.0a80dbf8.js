(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{558:function(t,s,n){"use strict";n.r(s);var a=n(56),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"nocs数据集"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nocs数据集"}},[t._v("#")]),t._v(" NOCS数据集")]),t._v(" "),n("h2",{attrs:{id:"class-id-与对应关系"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#class-id-与对应关系"}},[t._v("#")]),t._v(" class id 与对应关系")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("1:'02876657', Bottle\n\n2:'02880940',Bowl\n\n3:'02942699',Camera\n\n4:'02946921',Can\n\n5:'03642806',Laptop\n\n6:'03797390',Mug\n")])])]),n("h2",{attrs:{id:"obj-model"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#obj-model"}},[t._v("#")]),t._v(" obj_model")]),t._v(" "),n("p",[t._v("在obj_model数据集下的数据结构应该是")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v(" obj_model \n    Train 合成数据集的\n        Xxx（这些都是同一类的模型）\n            Xxxxx（这些都是单个模型）\n                Model.obj\n                Model.mtl\n                Bbox.txt\n            Xxxxx\n            Xxxxx\n            …\n        Xxx\n        Xxx\n        Xxx\n        …\n    Val 合成数据及的\n    Real_train\n    Real_test\n")])])]),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-Uy5ZIc.png",width:"100%"}}),t._v(" "),n("p",[t._v("其实不止SPD，大部分的工作都对mug类进行了额外处理。")]),t._v(" "),n("h2",{attrs:{id:"spd的处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spd的处理"}},[t._v("#")]),t._v(" SPD的处理")]),t._v(" "),n("p",[t._v("总结: 不建议看SPD的处理代码")]),t._v(" "),n("p",[t._v("SPD在预处理数据集的时候是分了三波处理的\ncamera_trian\nreal_train\ncamera+real test")]),t._v(" "),n("p",[t._v("1.在处理camera_train的时候，将深度图反投影得到点云pts，coord图计算点云coord_pts\n这两个点云计算相似变换，得到sRT")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-iB2HXC.png",width:"100%"}}),t._v(" "),n("p",[t._v("在align_nocs_to_depth中估计相似矩阵")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-BDNjnw.png",width:"100%"}}),t._v(" "),n("p",[t._v("2.在处理real_train时")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-CxWeTe.png",width:"100%"}}),t._v(" "),n("p",[t._v("可以看到缩放s是直接从字典scale_factors中根据model_list[i]（obj模型的名字）读取的，也就是说一个模型固定对应一个缩放，与场景无关。\n而缩放是从obj_model下雨.obj文件同目录的.txt中读取的，txt中只有三个数，这三个数组成的向量的模就是该模型的scale")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-NxENGY.png",width:"100%"}}),t._v("\n读取到scale之后，用来将_coord.png的颜色值 转为点云 \n具体是怎么转换的：\n\t读取_coord.png，交换维度满足BGR，将其由0~255映射到0~1，（还对Z进行了反转0.2变1-0.2=0.8这种）\n\t然后与mask结合，分别与每个实例的mask相乘\n\t得到coords，第0,1,3维是处理后的RGB值，第2维是实例，也就是说coord[:,:,0,:]是实例序号是0的coord\n可以理解成_coord.png的颜色值都被处理为0到1之间的，即xyz是[0,1]\n将xyz映射到[-s*0.5,s*0.5]，也就是将coord_pts放大s倍，然后用放大后的去\n"),n("p",[t._v("3.test\nsize是通过model_size得到的，model_size则是对物体的xyz每个维度找一个最大值然后乘以2，即找了一个3D bbox\ns则是通过sRT中的R，因为旋转矩阵满足RR-1 = I，所以可以计算出s，而sRT的来源又是camera_test_result.pkl,这个\n来自NOCS")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-p8jKaM.png",width:"100%"}}),t._v(" "),n("p",[t._v("下载后名为gts.zip，是根据scene_inst_prefix来读取的")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-fmPj5j.png",width:"50%"}}),t._v(" "),n("p",[t._v("每个pkl文件可以得到")]),t._v(" "),n("img",{attrs:{src:"https://raw.githubusercontent.com/winka9587/MD_imgs/main/Norproject/2022-08-24-Armzao.png",width:"100%"}}),t._v(" "),n("p",[t._v("使用的sRT就是来自这里")]),t._v(" "),n("p",[t._v("pts = sRT*coord_pts\n所以scale(代码中是s)就是指coord到pts的缩放，而size，则是物体在nocs下的尺寸，因为坐标在coord.png中作为颜色值存储0~255，而png的数据类型是uint8（范围是[0,255]），因此想要存储坐标就不得不面临缩放。需要用size将其恢复到原始尺寸。那么在缩放的时候最好的方法就是按对角线归一化，因此需要xyz的最大值。")]),t._v(" "),n("p",[t._v("那么，为什么camera_train计算相似矩阵，real_train用pnp，test又直接读取呢？")])])}),[],!1,null,null,null);s.default=r.exports}}]);